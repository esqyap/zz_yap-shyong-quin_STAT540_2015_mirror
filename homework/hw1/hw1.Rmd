---
title: "hw1"
author: "Eva Y"
date: "February 14, 2015"
output:
  html_document:
    keep_md: yes
---

### Q0 (0 pts) Intake

```{r}
suppressPackageStartupMessages(library(dplyr))
library(ggplot2)
library(car)

metadata <- read.delim("design.txt", header = TRUE)
nhbe_data <- read.delim("data.txt", header = TRUE)

# smell test
str(metadata)
str(nhbe_data)
```

### Q1 (1 points) What are the basic characteristics of the data and meta-data?
> #### Q1a: How many probes? How many samples (Bioassay)?
```{r}
nrow(nhbe_data) # number of probes
ncol(nhbe_data) # number of samples
```
**There are 22737 probes and 23 samples.**

> #### Q1b: What is the breakdown of samples (Bioassay) for agent, time?
```{r}
addmargins(with(metadata, table(Treatment, time)))
```
**For each time-point, there are three untreated samples and three samples treated with cigarette smoke, except for the one-hour time point which only has two samples.**

> #### Q1c: Create a quantitative (numeric) variable that represents the time at which cells were measured.
```{r}
metadata$time_num <- recode(metadata$time,
       "'1_h' = 1; '2_h' = 2; '24_h' = 24; '4_h' = 4",
       as.factor.result = FALSE) 

str(metadata$time_num) # check if the level is numeric
```

> #### Q1d: Create a plot showing the gene expression data for one probe and the averages for all possible combinations of agent and time.
```{r}
# pick random gene
set.seed(1)
(random_gene <- sample(1:nrow(nhbe_data), size = 1))
random_gene <- nhbe_data[random_gene, ]
gene_exp <- t(random_gene)
random_gene_df <- cbind(gene_exp, metadata)

# create data frame
random_gene_df <- with(random_gene_df, data.frame(ExternalID, Treatment, time, time_num, gene = factor(rep(c(colnames(random_gene_df[1])), each = nrow(random_gene_df))), gene_exp = c(gene_exp)))

# plot data
ggplot(random_gene_df, aes(x = time, y = gene_exp,  color = Treatment)) + geom_point() + stat_summary(fun.y = mean, geom = "point", shape = 4, size = 4) + xlab("Time post-treatment") + ylab("Gene expression") + ggtitle("Expression of 212598_at in NHBE cells")
```

### Q2 (2 points) Assessing data quality

> #### Q2a: Examine the sample-to-sample correlations in a heatmap.
```{r}

```

